schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw/data.xlsx
      hash: md5
      md5: 5878791f8961af5143d726b8a2964c0f
      size: 1055731
    - path: params.yaml
      hash: md5
      md5: c3536d4b1e68b87541cbbcc208f7d6f2
      size: 458
    - path: src/preprocess.py
      hash: md5
      md5: edb5325804150f45627fe4df806d0d74
      size: 2041
    params:
      params.yaml:
        data.processed_path: data/processed/train_test.joblib
        data.raw_path: data/raw/data.xlsx
        features.categorical_columns:
        - GS
        features.drop_columns:
        - cond rate
        - gas rate
        - sum cond
        - sum gas
        features.target: NPV
        preprocessing.random_state: 42
        preprocessing.test_size: 0.2
    outs:
    - path: data/processed/train_test.joblib
      hash: md5
      md5: 7529128e1d84fb367ab8192fbea58247
      size: 928180
    - path: models/encoder.joblib
      hash: md5
      md5: 97a5994e25d699c849c80f9c73a8db1b
      size: 1389
    - path: models/feature_columns.joblib
      hash: md5
      md5: bbb3a22cce65e92d97561c19fee2f343
      size: 109
  train:
    cmd: python src/train.py
    deps:
    - path: data/processed/train_test.joblib
      hash: md5
      md5: 7529128e1d84fb367ab8192fbea58247
      size: 928180
    - path: params.yaml
      hash: md5
      md5: c3536d4b1e68b87541cbbcc208f7d6f2
      size: 458
    - path: src/train.py
      hash: md5
      md5: 2aff6ed8bea61de1ec7c8760e1164f84
      size: 2413
    params:
      params.yaml:
        model.hyperparameters:
          n_estimators: 150
          max_depth: 5
          learning_rate: 0.05
          subsample: 0.8
        model.name: xgboost
        training.cv_folds: 5
        training.scoring: r2
    outs:
    - path: models/metrics.json
      hash: md5
      md5: 2a2dd7a5e1c78961586f52623ce6c5ce
      size: 163
    - path: models/model.joblib
      hash: md5
      md5: 3a1e867ef3cc50a1de846c0c65b06017
      size: 421861
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/processed/train_test.joblib
      hash: md5
      md5: 7529128e1d84fb367ab8192fbea58247
      size: 928180
    - path: models/model.joblib
      hash: md5
      md5: 3a1e867ef3cc50a1de846c0c65b06017
      size: 421861
    - path: src/evaluate.py
      hash: md5
      md5: d188b0517ac9098e19eaccf70bc0a79e
      size: 1638
    outs:
    - path: models/evaluation.json
      hash: md5
      md5: becf2355b94fa578ad68dedc84cc5a95
      size: 438
  generate_report:
    cmd: python src/generate_report.py
    deps:
    - path: models/evaluation.json
      hash: md5
      md5: becf2355b94fa578ad68dedc84cc5a95
      size: 438
    - path: models/metrics.json
      hash: md5
      md5: 2a2dd7a5e1c78961586f52623ce6c5ce
      size: 163
    - path: params.yaml
      hash: md5
      md5: c3536d4b1e68b87541cbbcc208f7d6f2
      size: 458
    - path: src/generate_report.py
      hash: md5
      md5: c560a7a9c25118b5036412f52e0e49d0
      size: 1712
    outs:
    - path: reports/model_report.json
      hash: md5
      md5: d30af247a1334763d83aaa0fb4d2d2e8
      size: 780
  register:
    cmd: python src/register_model.py
    deps:
    - path: params.yaml
      hash: md5
      md5: c3536d4b1e68b87541cbbcc208f7d6f2
      size: 458
    - path: src/register_model.py
      hash: md5
      md5: e1cc9c50645a29659d97cc4835cfd39d
      size: 3861
    params:
      params.yaml:
        model.name: xgboost
    outs:
    - path: registry/model_info.json
      hash: md5
      md5: 07222d6efb5ee993d7dc7a06a988b93d
      size: 178
